---
version: 0.1
runson: linux

autosplit: true
concurrency: 2

env:
  NUGET_PACKAGES: '/home/ltuser/.nuget/packages/'
  NUGET_HTTP_CACHE_PATH: '/home/ltuser/.local/share/NuGet/v3-cache'
  NUGET_PLUGINS_CACHE_PATH: '/home/ltuser/.local/share/NuGet/plugins-cache'

pre:
 - curl -sSL https://dot.net/v1/dotnet-install.sh -o dotnet-install.sh
 - chmod +x dotnet-install.sh
 - ./dotnet-install.sh --channel 8.0 --install-dir $HOME/.dotnet
 - export PATH="$HOME/.dotnet:$PATH"
 - export DOTNET_ROOT=$HOME/.dotnet
 - dotnet --version
 - dotnet restore
 - dotnet list NUnitHyperTestDemo/NUnitHyperTestDemo.csproj package > packages.txt
 - dotnet build -c Release

testDiscovery:
  type: raw
  mode: dynamic
  command: grep 'Category' NUnitHyperTestDemo -ir --include=\*.cs --exclude=DriverFactory.cs --exclude=HyperTestDemo.AssemblyInfo.cs | awk -F'"' '{print$2}'

testRunnerCommand: export PATH="$HOME/.dotnet:$PATH" && export DOTNET_ROOT=$HOME/.dotnet && dotnet test NUnitHyperTestDemo.sln --filter TestCategory=$test 

retryOnFailure: true
maxRetries: 1

jobLabel: [selenium-Nunit, linux, autosplit]
